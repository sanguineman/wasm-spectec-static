;; Lookup map with key
dec $lookup_<K, V>(map<K, V>, K) : V?
def $lookup_<K, V>(eps, K) = eps
def $lookup_<K, V>((K_h -> V_h)::(K_t -> V_t)*, K) = V_h
  -- if K_h = K_query
def $lookup_<K, V>((K_h -> V_h):: (K_t -> V_t)*, K)
  = $lookup_<K, V>((K_t -> V_t)*, K)
  -- otherwise

def $lookup_context(contextLayer, id) = $lookup_<id, type>(contextLayer, id)
def $lookup_env(envLayer, id) = $lookup_<id, value>(envLayer, id)
